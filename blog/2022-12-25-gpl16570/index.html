<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.6.0 for Hugo" />
  

  
  












  
  










  







  
  

  
  
  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="Commomly, researchers have developed many R packages for gene annotation and host them in Bioconductor. For most data series from NCBI Gene Expression Omnibus (GEO), we can find annotation packages. Yet, we may encounter with some data series without such packages, such as GSE65783." />

  
  <link rel="alternate" hreflang="en-us" href="https://example.com/blog/2022-12-25-gpl16570/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.7579f2ea081d74b9cb40a7d984071feb.css" />

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



  


  


  




  
  
  

  
  

  
  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu1efa9af2edf414d45fb59503b457ea16_13437_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu1efa9af2edf414d45fb59503b457ea16_13437_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://example.com/blog/2022-12-25-gpl16570/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />
  
  <meta property="og:site_name" content="BM Sci-Tech Memento" />
  <meta property="og:url" content="https://example.com/blog/2022-12-25-gpl16570/" />
  <meta property="og:title" content="Gene annotation of GPL16686 with R | BM Sci-Tech Memento" />
  <meta property="og:description" content="Commomly, researchers have developed many R packages for gene annotation and host them in Bioconductor. For most data series from NCBI Gene Expression Omnibus (GEO), we can find annotation packages. Yet, we may encounter with some data series without such packages, such as GSE65783." /><meta property="og:image" content="https://example.com/media/icon_hu1efa9af2edf414d45fb59503b457ea16_13437_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://example.com/media/icon_hu1efa9af2edf414d45fb59503b457ea16_13437_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-12-25T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-12-25T00:00:00&#43;00:00">
  

  



  

  


  <title>Gene annotation of GPL16686 with R | BM Sci-Tech Memento</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="474748a5f53807b7f3ca388e12149ec9" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.613040fe4f2c0f007b4dcb64404201cb.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">BM Sci-Tech Memento</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">BM Sci-Tech Memento</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/tool/"><span>Tools</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/docs/"><span>Notes</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://pubmed.ncbi.nlm.nih.gov/" target="_blank" rel="noopener"><span>PubMed</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://licore.netlify.app/" target="_blank" rel="noopener"><span>MII</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Gene annotation of GPL16686 with R</h1>

  
  <p class="page-subtitle">GEO platform annotation without bioconductor package</p>
  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Sunday, 25 December 2022 
  </span>
  

  

  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>Commomly, researchers have developed many R packages for gene annotation and host them in <a href="https://www.bioconductor.org/" target="_blank" rel="noopener">Bioconductor</a>. For most data series from <a href="https://www.ncbi.nlm.nih.gov/geo/" target="_blank" rel="noopener">NCBI Gene Expression Omnibus (GEO)</a>, we can find annotation packages. Yet, we may encounter with some data series without such packages, such as <font color = "#FF00FF"><strong><em><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65783" target="_blank" rel="noopener">GSE65783</a></em></strong></font>.</p>
<p>Previously, 4 ways to ðŸ‘‰<u><em><a href="/blog/2019-12-07-r-get-geo-platform/"><strong>Get GEO platform annotation file and import into R</strong></a></em></u> were introduced, which can be accessed by clicking the name underlined and in italic.</p>
<p>Here shares are the scripts for gene annotation of data series <font color = "#FF00FF"><strong><em><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65783" target="_blank" rel="noopener">GSE65783</a></em></strong></font> from GEO.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">rm</span><span class="p">(</span><span class="n">list</span> <span class="o">=</span> <span class="nf">ls</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load R packages</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">GEOquery</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">clusterProfiler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">org.Mm.eg.db</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># load GEO platform data</span>
</span></span><span class="line"><span class="cl"><span class="n">gseID</span> <span class="o">&lt;-</span> <span class="s">&#34;GSE65783&#34;</span> <span class="c1"># platformID &lt;- &#34;GPL16570&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nf">load</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="n">gseID</span><span class="p">,</span> <span class="s">&#34;.GPL.Rdata&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># check gpl with View() OR head()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># result of View() shown in Figure 1</span>
</span></span><span class="line"><span class="cl"><span class="nf">View</span><span class="p">(</span><span class="n">gpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">gpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl"><span class="n">[1]</span> <span class="s">&#34;ID&#34;</span>                    <span class="s">&#34;probeset_id&#34;</span>           <span class="s">&#34;SPOT_ID&#34;</span>               <span class="s">&#34;seqname&#34;</span>               <span class="s">&#34;strand&#34;</span>                <span class="s">&#34;start&#34;</span>        
</span></span><span class="line"><span class="cl"><span class="n">[7]</span> <span class="s">&#34;stop&#34;</span>                  <span class="s">&#34;total_probes&#34;</span>          <span class="s">&#34;gene_assignment&#34;</span>       <span class="s">&#34;mrna_assignment&#34;</span>       <span class="s">&#34;swissprot&#34;</span>             <span class="s">&#34;unigene&#34;</span>      
</span></span><span class="line"><span class="cl"><span class="n">[13]</span> <span class="s">&#34;GO_biological_process&#34;</span> <span class="s">&#34;GO_cellular_component&#34;</span> <span class="s">&#34;GO_molecular_function&#34;</span> <span class="s">&#34;pathway&#34;</span>               <span class="s">&#34;protein_domains&#34;</span>       <span class="s">&#34;crosshyb_type&#34;</span>        
</span></span><span class="line"><span class="cl"><span class="n">[19]</span> <span class="s">&#34;category&#34;</span>
</span></span></code></pre></div>















<figure  id="figure-result-of-viewgpl">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="Result of View(gpl)" srcset="
               /media/res-view-GPL16570_hue7cb36991408f54d2ea2d0ce1cd2d913_167131_76e11e93a04c49f208dbbc1f22d18350.webp 400w,
               /media/res-view-GPL16570_hue7cb36991408f54d2ea2d0ce1cd2d913_167131_d2978be2e0ae5d5fd91aa32a49fbebb2.webp 760w,
               /media/res-view-GPL16570_hue7cb36991408f54d2ea2d0ce1cd2d913_167131_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/media/res-view-GPL16570_hue7cb36991408f54d2ea2d0ce1cd2d913_167131_76e11e93a04c49f208dbbc1f22d18350.webp"
               width="760"
               height="436"
               loading="lazy" data-zoomable /></div>
  </div><figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
      Result of View(gpl)
    </figcaption></figure>
<p>look through the result table and look up gene IDs. In Figure 1, we will find genes, including Gene Symbols and ENTREZ IDs, in <code>Column 9</code> with column name of <code>gene_assignment</code>.</p>
<p>Extract required infornmations conaining probe IDs and Genes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">gpl_Sense</span> <span class="o">&lt;-</span> <span class="n">gpl[</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Delete columns without genes</span>
</span></span><span class="line"><span class="cl"><span class="n">gpl_Sense</span> <span class="o">&lt;-</span> <span class="n">gpl_Sense[gpl_Sense[</span><span class="p">,</span> <span class="m">9</span><span class="n">]</span> <span class="o">!=</span> <span class="s">&#34;---&#34;</span><span class="p">,</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="nf">View</span><span class="p">(</span><span class="n">gpl_Sense</span><span class="p">)</span>
</span></span></code></pre></div>















<figure  id="figure-result-of-selected-gpl">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="Result of Selected gpl" srcset="
               /media/res-view-GPL16570_Sense_hub755bf2a927c65bd537477cd590f1577_147934_e38744256e7938ca75ed007c9963ca82.webp 400w,
               /media/res-view-GPL16570_Sense_hub755bf2a927c65bd537477cd590f1577_147934_573ac33980bc81f96a8f47f6caae86bd.webp 760w,
               /media/res-view-GPL16570_Sense_hub755bf2a927c65bd537477cd590f1577_147934_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/media/res-view-GPL16570_Sense_hub755bf2a927c65bd537477cd590f1577_147934_e38744256e7938ca75ed007c9963ca82.webp"
               width="760"
               height="587"
               loading="lazy" data-zoomable /></div>
  </div><figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
      Result of Selected gpl
    </figcaption></figure>
<p>Defined a function to extract genes from <code>Column 9</code>, namely, <code>gene_assignment</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">geneEXT</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;//&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">genelists</span> <span class="o">=</span> <span class="nf">c</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">split_i</span> <span class="o">=</span> <span class="nf">str_split</span><span class="p">(</span><span class="n">df[i</span><span class="p">,</span> <span class="n">]</span><span class="o">$</span><span class="n">gene_assignment</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">gene_i</span> <span class="o">&lt;-</span> <span class="n">split_i</span><span class="nf">[length</span><span class="p">(</span><span class="n">split_i</span><span class="p">)</span><span class="n">]</span> <span class="c1"># Extract the last element (ENTREZID)</span>
</span></span><span class="line"><span class="cl">      <span class="n">genelists[i]</span> <span class="o">=</span> <span class="n">gene_i</span> <span class="c1"># Create a Gene vector</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">return</span><span class="p">(</span><span class="n">genelists</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Extract genes with the self-defined function above</span>
</span></span><span class="line"><span class="cl"><span class="n">geneSUM</span> <span class="o">&lt;-</span> <span class="nf">geneEXT</span><span class="p">(</span><span class="n">gpl_Sense</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#39;// &#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>Generate pre-ids data frame</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">ids_V0</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">probe_id</span> <span class="o">=</span> <span class="n">gpl_Sense</span><span class="o">$</span><span class="n">ID</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="n">ENTREZID</span> <span class="o">=</span> <span class="n">geneSUM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">ids_V0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl">  <span class="n">probe_id</span> <span class="n">ENTREZID</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span> <span class="m">17210855</span>    <span class="m">18777</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span> <span class="m">17210869</span>    <span class="m">21399</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span> <span class="m">17210887</span>   <span class="m">108664</span>
</span></span><span class="line"><span class="cl"><span class="m">4</span> <span class="m">17210904</span>    <span class="m">18387</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span> <span class="m">17210912</span>    <span class="m">12421</span>
</span></span><span class="line"><span class="cl"><span class="m">6</span> <span class="m">17210947</span>   <span class="m">620393</span>
</span></span></code></pre></div><div class="alert alert-note">
  <div>
    Now, ids_V0 contains probe IDS genes in <code>ENTREZID</code> format but not displayed as <code>SYMBOL</code>.
  </div>
</div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Convert ENTREZID to gene SYMBOL</span>
</span></span><span class="line"><span class="cl"><span class="n">geneSYMBOL</span> <span class="o">&lt;-</span> <span class="nf">bitr</span><span class="p">(</span><span class="n">geneSUM</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">fromType</span> <span class="o">=</span> <span class="s">&#39;ENTREZID&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">toType</span> <span class="o">=</span> <span class="s">&#39;SYMBOL&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                   <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.Mm.eg.db</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl"><span class="s">&#39;select()&#39;</span> <span class="n">returned</span> <span class="m">1</span><span class="o">:</span><span class="m">1</span> <span class="n">mapping</span> <span class="n">between</span> <span class="n">keys</span> <span class="n">and</span> <span class="n">columns</span>
</span></span><span class="line"><span class="cl"><span class="n">Warning</span> <span class="n">message</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="nf">bitr</span><span class="p">(</span><span class="n">geneSUM</span><span class="p">,</span> <span class="n">fromType</span> <span class="o">=</span> <span class="s">&#34;ENTREZID&#34;</span><span class="p">,</span> <span class="n">toType</span> <span class="o">=</span> <span class="s">&#34;SYMBOL&#34;</span><span class="p">,</span> <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.Mm.eg.db</span><span class="p">)</span> <span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="m">2.79</span>% <span class="n">of</span> <span class="n">input</span> <span class="n">gene</span> <span class="n">IDs</span> <span class="n">are</span> <span class="n">fail</span> <span class="n">to</span> <span class="n">map...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">geneSYMBOL</span><span class="p">)</span> <span class="c1"># OR View(geneSYMBOL)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl">  <span class="n">ENTREZID</span>  <span class="n">SYMBOL</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span>    <span class="m">18777</span>  <span class="n">Lypla1</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span>    <span class="m">21399</span>   <span class="n">Tcea1</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span>   <span class="m">108664</span> <span class="n">Atp6v1h</span>
</span></span><span class="line"><span class="cl"><span class="m">4</span>    <span class="m">18387</span>   <span class="n">Oprk1</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span>    <span class="m">12421</span>  <span class="n">Rb1cc1</span>
</span></span><span class="line"><span class="cl"><span class="m">6</span>   <span class="m">620393</span>  <span class="n">Alkal1</span>
</span></span></code></pre></div><div class="alert alert-note">
  <div>
    <ul>
<li>Pay attention to the <u><strong>Warning message</strong></u> when running bitr().</li>
<li><u><strong>2.79% of input gene IDs are fail to map&hellip;</strong></u> means probes without annotation exist.</li>
</ul>
  </div>
</div>
<p>Now we have got <font color = "#01B468"><strong>genes as <u>SYMBOLs</u></strong></font>, but they are in different tables with probes. So we need to merge them together.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># check the data type of probes and genes</span>
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">geneSYMBOL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl"><span class="n">[1]</span> <span class="s">&#34;data.frame&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">ids_V0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl"><span class="n">[1]</span> <span class="s">&#34;data.frame&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># merge two data frames of probes and genes</span>
</span></span><span class="line"><span class="cl"><span class="n">ids_V0</span> <span class="o">&lt;-</span> <span class="n">ids_V0[ids_V0</span><span class="o">$</span><span class="n">ENTREZID</span> <span class="o">%in%</span> <span class="n">geneSYMBOL</span><span class="o">$</span><span class="n">ENTREZID</span><span class="p">,</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ids</span> <span class="o">&lt;-</span> <span class="nf">merge</span><span class="p">(</span><span class="n">ids_V0</span><span class="p">,</span> <span class="n">geneSYMBOL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">by</span> <span class="o">=</span> <span class="s">&#39;ENTREZID&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl">   <span class="n">ENTREZID</span> <span class="n">probe_id</span>        <span class="n">SYMBOL</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span> <span class="m">100009600</span> <span class="m">17524590</span>         <span class="n">Zglp1</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span> <span class="m">100009609</span> <span class="m">17493037</span>       <span class="n">Vmn2r65</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span> <span class="m">100009614</span> <span class="m">17234709</span>       <span class="n">Gm10024</span>
</span></span><span class="line"><span class="cl"><span class="m">4</span> <span class="m">100009664</span> <span class="m">17248721</span> <span class="n">F630206G17Rik</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span>    <span class="m">100012</span> <span class="m">17432514</span>          <span class="n">Oog3</span>
</span></span><span class="line"><span class="cl"><span class="m">6</span>    <span class="m">100017</span> <span class="m">17431350</span>       <span class="n">Ldlrap1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">dim</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Result:</span>
</span></span><span class="line"><span class="cl"><span class="n">[1]</span> <span class="m">26283</span>     <span class="m">3</span>
</span></span></code></pre></div><p>Finish with saving ids as <code>Rdata</code>, which can be loaded with <code>Load()</code> quickly.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;ids.Rdata&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ul class="cta-group">
  
  <li>
    <a href="/blog/"  class="btn btn-primary px-3 py-3"><font color='white'> &lt; Back to Blog </font></a>
  </li>
  
  
  <li>
    <a href="/" >
      Alternative to Homepage <i class="fas fa-angle-right"></i>
    </a>
  </li>
  
</ul>


    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/bioinformatics/">Bioinformatics</a>
  
  <a class="badge badge-light" href="/tag/programming/">Programming</a>
  
  <a class="badge badge-light" href="/tag/data-mining/">Data Mining</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
  </ul>
</div>


























  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  

  

  

  
  






  
  <p class="powered-by copyright-license-text">
    Copyright Â© 2023 | Biomedist | All rights reserved.
  </p>
  




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> â€” the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js" type="module"></script>








  
  


<script src="/en/js/wowchemy.min.54dd6e4d8f2e4b1d098381b57f18dd83.js"></script>























</body>
</html>
